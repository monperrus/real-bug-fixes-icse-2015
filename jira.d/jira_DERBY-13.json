{"expand":"renderedFields,names,schema,transitions,operations,editmeta,changelog","id":"27518","self":"https://issues.apache.org/jira/rest/api/latest/issue/27518","key":"DERBY-13","fields":{"issuetype":{"self":"https://issues.apache.org/jira/rest/api/2/issuetype/1","id":"1","description":"A problem which impairs or prevents the functions of the product.","iconUrl":"https://issues.apache.org/jira/images/icons/issuetypes/bug.png","name":"Bug","subtask":false},"timespent":null,"project":{"self":"https://issues.apache.org/jira/rest/api/2/project/10594","id":"10594","key":"DERBY","name":"Derby","avatarUrls":{"48x48":"https://issues.apache.org/jira/secure/projectavatar?pid=10594&avatarId=10122","24x24":"https://issues.apache.org/jira/secure/projectavatar?size=small&pid=10594&avatarId=10122","16x16":"https://issues.apache.org/jira/secure/projectavatar?size=xsmall&pid=10594&avatarId=10122","32x32":"https://issues.apache.org/jira/secure/projectavatar?size=medium&pid=10594&avatarId=10122"},"projectCategory":{"self":"https://issues.apache.org/jira/rest/api/2/projectCategory/10090","id":"10090","description":"DB related projects","name":"DB"}},"fixVersions":[{"self":"https://issues.apache.org/jira/rest/api/2/version/10993","id":"10993","description":"","name":"10.1.1.0","archived":false,"released":true,"releaseDate":"2005-08-03"}],"aggregatetimespent":null,"resolution":{"self":"https://issues.apache.org/jira/rest/api/2/resolution/1","id":"1","description":"A fix for this issue is checked into the tree and tested.","name":"Fixed"},"customfield_12310220":"2004-12-01 12:29:42.0","customfield_12312322":null,"customfield_12312323":null,"customfield_12310420":"21714","customfield_12310222":"1_*:*_1_*:*_20552505000_*|*_6_*:*_1_*:*_0_*|*_5_*:*_1_*:*_3747000","customfield_12312320":null,"customfield_12312321":null,"customfield_12312120":null,"customfield_12312121":null,"resolutiondate":"2005-05-25T15:53:13.000+0000","workratio":-1,"customfield_12312328":null,"customfield_12312329":null,"customfield_12312326":null,"customfield_12310300":null,"customfield_12312327":null,"customfield_12312324":null,"customfield_12312325":null,"lastViewed":null,"watches":{"self":"https://issues.apache.org/jira/rest/api/2/issue/DERBY-13/watchers","watchCount":0,"isWatching":false},"created":"2004-09-29T18:51:28.000+0000","priority":{"self":"https://issues.apache.org/jira/rest/api/2/priority/4","iconUrl":"https://issues.apache.org/jira/images/icons/priorities/minor.png","name":"Minor","id":"4"},"labels":[],"customfield_12312333":null,"customfield_12312334":null,"customfield_12310310":"3.0","customfield_12312331":null,"customfield_12312332":null,"timeestimate":null,"aggregatetimeoriginalestimate":null,"versions":[{"self":"https://issues.apache.org/jira/rest/api/2/version/10920","id":"10920","description":"initial source drop","name":"10.0.2.0","archived":false,"released":true,"releaseDate":"2004-08-30"}],"customfield_12311120":null,"customfield_12312330":null,"issuelinks":[],"customfield_12312339":null,"assignee":{"self":"https://issues.apache.org/jira/rest/api/2/user?username=shreyas","name":"shreyas","emailAddress":"Shreyas at sun dot com","avatarUrls":{"48x48":"https://issues.apache.org/jira/secure/useravatar?avatarId=10452","24x24":"https://issues.apache.org/jira/secure/useravatar?size=small&avatarId=10452","16x16":"https://issues.apache.org/jira/secure/useravatar?size=xsmall&avatarId=10452","32x32":"https://issues.apache.org/jira/secure/useravatar?size=medium&avatarId=10452"},"displayName":"Shreyas Kaushik","active":true},"customfield_12312337":null,"customfield_12312338":null,"updated":"2006-07-08T10:06:51.000+0000","customfield_12312335":null,"customfield_12311720":null,"customfield_12312336":null,"status":{"self":"https://issues.apache.org/jira/rest/api/2/status/6","description":"The issue is considered finished, the resolution is correct. Issues which are closed can be reopened.","iconUrl":"https://issues.apache.org/jira/images/icons/statuses/closed.png","name":"Closed","id":"6","statusCategory":{"self":"https://issues.apache.org/jira/rest/api/2/statuscategory/3","id":3,"key":"done","colorName":"green","name":"Complete"}},"components":[{"self":"https://issues.apache.org/jira/rest/api/2/component/11408","id":"11408","name":"SQL"}],"timeoriginalestimate":null,"description":"Opening this bug on behalf of Satheesh Bandaram\n\n---------------------------------------------------------\nThe compiler mishandles quoted names with embedded periods when \nchecking uniqueness of table names in the from list of a \nSELECT. Consider the following SQL:\n  create table \"S1.T1\" (id int not null primary key, d1 int);\n  create schema s1;\n  create table s1.t1 (id int not null primary key, d2 int);\n  select * from s1.t1, \"S1.T1\" where s1.t1.id = \"S1.T1\".id;\nDerby throws an error on the final SELECT statement:\n\"ERROR 42X09: The table or alias name 'S1.T1' is used more than \nonce in the FROM list\". However s1.t1 and \"S1.T1\" are different \ntables.","customfield_10010":null,"timetracking":{},"customfield_12312026":null,"customfield_12310200":null,"customfield_12312023":null,"customfield_12312024":null,"customfield_12312340":null,"aggregatetimeestimate":null,"customfield_12312022":null,"customfield_12312341":null,"customfield_12312220":null,"customfield_12310921":null,"customfield_12310920":"40594","summary":"Quoted names with embedded period mishandled in from list","creator":{"self":"https://issues.apache.org/jira/rest/api/2/user?username=ramank","name":"ramank","emailAddress":"ramank at Yngvi dot Org","avatarUrls":{"48x48":"https://issues.apache.org/jira/secure/useravatar?avatarId=10452","24x24":"https://issues.apache.org/jira/secure/useravatar?size=small&avatarId=10452","16x16":"https://issues.apache.org/jira/secure/useravatar?size=xsmall&avatarId=10452","32x32":"https://issues.apache.org/jira/secure/useravatar?size=medium&avatarId=10452"},"displayName":"Ramandeep Kaur","active":true},"subtasks":[],"customfield_12310090":null,"reporter":{"self":"https://issues.apache.org/jira/rest/api/2/user?username=ramank","name":"ramank","emailAddress":"ramank at Yngvi dot Org","avatarUrls":{"48x48":"https://issues.apache.org/jira/secure/useravatar?avatarId=10452","24x24":"https://issues.apache.org/jira/secure/useravatar?size=small&avatarId=10452","16x16":"https://issues.apache.org/jira/secure/useravatar?size=xsmall&avatarId=10452","32x32":"https://issues.apache.org/jira/secure/useravatar?size=medium&avatarId=10452"},"displayName":"Ramandeep Kaur","active":true},"customfield_12310291":null,"customfield_12310290":null,"aggregateprogress":{"progress":0,"total":0},"environment":null,"customfield_12311020":null,"customfield_12310050":null,"duedate":null,"customfield_12310250":null,"progress":{"progress":0,"total":0},"comment":{"startAt":0,"maxResults":18,"total":18,"comments":[{"self":"https://issues.apache.org/jira/rest/api/2/issue/27518/comment/56055","id":"56055","author":{"self":"https://issues.apache.org/jira/rest/api/2/user?username=shreyas","name":"shreyas","emailAddress":"Shreyas at sun dot com","avatarUrls":{"48x48":"https://issues.apache.org/jira/secure/useravatar?avatarId=10452","24x24":"https://issues.apache.org/jira/secure/useravatar?size=small&avatarId=10452","16x16":"https://issues.apache.org/jira/secure/useravatar?size=xsmall&avatarId=10452","32x32":"https://issues.apache.org/jira/secure/useravatar?size=medium&avatarId=10452"},"displayName":"Shreyas Kaushik","active":true},"body":"Attached is the patch for this bug. Please review and give comments.","updateAuthor":{"self":"https://issues.apache.org/jira/rest/api/2/user?username=shreyas","name":"shreyas","emailAddress":"Shreyas at sun dot com","avatarUrls":{"48x48":"https://issues.apache.org/jira/secure/useravatar?avatarId=10452","24x24":"https://issues.apache.org/jira/secure/useravatar?size=small&avatarId=10452","16x16":"https://issues.apache.org/jira/secure/useravatar?size=xsmall&avatarId=10452","32x32":"https://issues.apache.org/jira/secure/useravatar?size=medium&avatarId=10452"},"displayName":"Shreyas Kaushik","active":true},"created":"2004-12-01T12:29:42.000+0000","updated":"2004-12-01T12:29:42.000+0000"},{"self":"https://issues.apache.org/jira/rest/api/2/issue/27518/comment/56056","id":"56056","author":{"self":"https://issues.apache.org/jira/rest/api/2/user?username=hlavac","name":"hlavac","emailAddress":"hlavac at code dot cz","avatarUrls":{"48x48":"https://issues.apache.org/jira/secure/useravatar?avatarId=10452","24x24":"https://issues.apache.org/jira/secure/useravatar?size=small&avatarId=10452","16x16":"https://issues.apache.org/jira/secure/useravatar?size=xsmall&avatarId=10452","32x32":"https://issues.apache.org/jira/secure/useravatar?size=medium&avatarId=10452"},"displayName":"Jan Hlavatý","active":true},"body":"I believe SQL92 limits table names to letters, numbers and underscore characters (with underscore and number not being first character of the identifier), so if the first create table statement creates table with actual name \"S1.T1\" it is probably wrong.\r\n\r\nSome syntax definitions from ANSI X3.135-1992:\r\n\r\n<table name> ::= <qualified name> | <qualified local table name>\r\n<qualified local table name> ::= MODULE <period> <local table name>\r\n<local table name> ::= <qualified identifier>\r\n<qualified identifier> ::= <identifier>\r\n<qualified name> ::= [ <schema name> <period> ] <qualified identifier>\r\n<identifier> ::= [ <introducer><character set specification> ] <actual identifier>\r\n<actual identifier> ::= <regular identifier> | <delimited identifier>\r\n<regular identifier> ::= <identifier body>\r\n<identifier body> ::= <identifier start> [ { <underscore> | <identifier part> }... ]\r\n<identifier part> ::= <identifier start> | <digit>\r\n\r\n1) An <identifier start> is one of:\r\na) A <simple Latin letter>; or\r\nb) A character that is identified as a letter in the character repertoire identified by the <module character set specification> or by the <character set specification>; or\r\nc) A character that is identified as a syllable in the character repertoire identified by the <module character set specification> or by the <character set specification>; or\r\nd) A character that is identified as an ideograph in the character repertoire identified by the <module character set specification> or by the <character set specification>.\r\n","updateAuthor":{"self":"https://issues.apache.org/jira/rest/api/2/user?username=hlavac","name":"hlavac","emailAddress":"hlavac at code dot cz","avatarUrls":{"48x48":"https://issues.apache.org/jira/secure/useravatar?avatarId=10452","24x24":"https://issues.apache.org/jira/secure/useravatar?size=small&avatarId=10452","16x16":"https://issues.apache.org/jira/secure/useravatar?size=xsmall&avatarId=10452","32x32":"https://issues.apache.org/jira/secure/useravatar?size=medium&avatarId=10452"},"displayName":"Jan Hlavatý","active":true},"created":"2004-12-01T13:23:30.000+0000","updated":"2004-12-01T13:23:30.000+0000"},{"self":"https://issues.apache.org/jira/rest/api/2/issue/27518/comment/56061","id":"56061","author":{"self":"https://issues.apache.org/jira/rest/api/2/user?username=jackklebanoff","name":"jackklebanoff","emailAddress":"klebanoff-derby at sbcglobal dot net","avatarUrls":{"48x48":"https://issues.apache.org/jira/secure/useravatar?avatarId=10452","24x24":"https://issues.apache.org/jira/secure/useravatar?size=small&avatarId=10452","16x16":"https://issues.apache.org/jira/secure/useravatar?size=xsmall&avatarId=10452","32x32":"https://issues.apache.org/jira/secure/useravatar?size=medium&avatarId=10452"},"displayName":"Jack Klebanoff","active":true},"body":"The SQL standard does allow just about anything inside a <delimited identifier>.  A delimited identifier is a string delimited by double quotes. For instance, the SQL standard allows\r\n  create table \"S1.T1\" ...\r\n  select * from \"S1.T1\"\r\n","updateAuthor":{"self":"https://issues.apache.org/jira/rest/api/2/user?username=jackklebanoff","name":"jackklebanoff","emailAddress":"klebanoff-derby at sbcglobal dot net","avatarUrls":{"48x48":"https://issues.apache.org/jira/secure/useravatar?avatarId=10452","24x24":"https://issues.apache.org/jira/secure/useravatar?size=small&avatarId=10452","16x16":"https://issues.apache.org/jira/secure/useravatar?size=xsmall&avatarId=10452","32x32":"https://issues.apache.org/jira/secure/useravatar?size=medium&avatarId=10452"},"displayName":"Jack Klebanoff","active":true},"created":"2004-12-01T16:07:37.000+0000","updated":"2004-12-01T16:07:37.000+0000"},{"self":"https://issues.apache.org/jira/rest/api/2/issue/27518/comment/56067","id":"56067","author":{"self":"https://issues.apache.org/jira/rest/api/2/user?username=rp0428","name":"rp0428","emailAddress":"rp0428 at pacbell dot net","avatarUrls":{"48x48":"https://issues.apache.org/jira/secure/useravatar?avatarId=10452","24x24":"https://issues.apache.org/jira/secure/useravatar?size=small&avatarId=10452","16x16":"https://issues.apache.org/jira/secure/useravatar?size=xsmall&avatarId=10452","32x32":"https://issues.apache.org/jira/secure/useravatar?size=medium&avatarId=10452"},"displayName":"Rick Post","active":true},"body":"I think that the proposed patch is either incorrect or incomplete.\r\n\r\n1. There are two 'equals' methods in Tablename.java: one takes only a table name argument and the other takes both table name and schema name arguments. Don't they both need to be modified?\r\n\r\n2. The proposed change to the first 'equals' method in  Tablename.java returns false if the argument table name is null. But the comment block at the beginning of the method states that 'TableNames are equal if their both their schemaNames and tableNames are\r\n\t * equal, or if this node's full table name is null'. If this comment is correct then 'true' should be returned if 'this nodes full table name is null' whether the argument is null or not. If this comment is not correct then it should be corrected. Since the same comment appears before the second 'equals' method the second method will need to be modified to reflect the same business rule.\r\n before the \r\n\r\n","updateAuthor":{"self":"https://issues.apache.org/jira/rest/api/2/user?username=rp0428","name":"rp0428","emailAddress":"rp0428 at pacbell dot net","avatarUrls":{"48x48":"https://issues.apache.org/jira/secure/useravatar?avatarId=10452","24x24":"https://issues.apache.org/jira/secure/useravatar?size=small&avatarId=10452","16x16":"https://issues.apache.org/jira/secure/useravatar?size=xsmall&avatarId=10452","32x32":"https://issues.apache.org/jira/secure/useravatar?size=medium&avatarId=10452"},"displayName":"Rick Post","active":true},"created":"2004-12-01T19:03:13.000+0000","updated":"2004-12-01T19:03:13.000+0000"},{"self":"https://issues.apache.org/jira/rest/api/2/issue/27518/comment/56078","id":"56078","author":{"self":"https://issues.apache.org/jira/rest/api/2/user?username=bandaram","name":"bandaram","emailAddress":"bandaram at gmail dot com","avatarUrls":{"48x48":"https://issues.apache.org/jira/secure/useravatar?avatarId=10452","24x24":"https://issues.apache.org/jira/secure/useravatar?size=small&avatarId=10452","16x16":"https://issues.apache.org/jira/secure/useravatar?size=xsmall&avatarId=10452","32x32":"https://issues.apache.org/jira/secure/useravatar?size=medium&avatarId=10452"},"displayName":"Satheesh Bandaram","active":true},"body":"I believe the proposed patch is incorrect. The patch would incorrectly accept statements like \r\nselect * from t1 a, t2 a where a.i = 5\r\n\r\nThe current checking for duplicate exposed names is correct. I think the problem here is caused because Derby currently stores both S1.T1 and \"S1.T1\" tables as having the same exposed name, S1.T1. At the compile time, we are not able tell if it was originally S1.T1 or \"S1.T1\"\r\n\r\nOne solution might be to store \"delimited identifiers\" along with their quotes... In this case, one table would have the exposed name S1.T1 and the other \"S1.T1\". But this might have impact on some other parts of the code.\r\n\r\nNote that following queries are currently accepted, when both should fail:\r\nij> select s1.t1.* from \"S1.T1\";\r\nID         |D1\r\n-----------------------\r\n\r\n0 rows selected\r\nij>  select \"S1.T1\".* from s1.t1;\r\nID         |D2\r\n-----------------------\r\n\r\n0 rows selected\r\n\r\n","updateAuthor":{"self":"https://issues.apache.org/jira/rest/api/2/user?username=bandaram","name":"bandaram","emailAddress":"bandaram at gmail dot com","avatarUrls":{"48x48":"https://issues.apache.org/jira/secure/useravatar?avatarId=10452","24x24":"https://issues.apache.org/jira/secure/useravatar?size=small&avatarId=10452","16x16":"https://issues.apache.org/jira/secure/useravatar?size=xsmall&avatarId=10452","32x32":"https://issues.apache.org/jira/secure/useravatar?size=medium&avatarId=10452"},"displayName":"Satheesh Bandaram","active":true},"created":"2004-12-02T02:13:23.000+0000","updated":"2004-12-02T02:13:23.000+0000"},{"self":"https://issues.apache.org/jira/rest/api/2/issue/27518/comment/56090","id":"56090","author":{"self":"https://issues.apache.org/jira/rest/api/2/user?username=hlavac","name":"hlavac","emailAddress":"hlavac at code dot cz","avatarUrls":{"48x48":"https://issues.apache.org/jira/secure/useravatar?avatarId=10452","24x24":"https://issues.apache.org/jira/secure/useravatar?size=small&avatarId=10452","16x16":"https://issues.apache.org/jira/secure/useravatar?size=xsmall&avatarId=10452","32x32":"https://issues.apache.org/jira/secure/useravatar?size=medium&avatarId=10452"},"displayName":"Jan Hlavatý","active":true},"body":"I think you need to store table name as a pair <schma,name>, not as a single String.\r\nAs delimited identifiers can contain arbitrary characters, you dont have a reliable delimiter character to separate, and any escaping mechanism would be costly.","updateAuthor":{"self":"https://issues.apache.org/jira/rest/api/2/user?username=hlavac","name":"hlavac","emailAddress":"hlavac at code dot cz","avatarUrls":{"48x48":"https://issues.apache.org/jira/secure/useravatar?avatarId=10452","24x24":"https://issues.apache.org/jira/secure/useravatar?size=small&avatarId=10452","16x16":"https://issues.apache.org/jira/secure/useravatar?size=xsmall&avatarId=10452","32x32":"https://issues.apache.org/jira/secure/useravatar?size=medium&avatarId=10452"},"displayName":"Jan Hlavatý","active":true},"created":"2004-12-02T10:32:26.000+0000","updated":"2004-12-02T10:32:26.000+0000"},{"self":"https://issues.apache.org/jira/rest/api/2/issue/27518/comment/56109","id":"56109","author":{"self":"https://issues.apache.org/jira/rest/api/2/user?username=djd","name":"djd","emailAddress":"djd at apache dot org","avatarUrls":{"48x48":"https://issues.apache.org/jira/secure/useravatar?avatarId=10452","24x24":"https://issues.apache.org/jira/secure/useravatar?size=small&avatarId=10452","16x16":"https://issues.apache.org/jira/secure/useravatar?size=xsmall&avatarId=10452","32x32":"https://issues.apache.org/jira/secure/useravatar?size=medium&avatarId=10452"},"displayName":"Daniel John Debrunner","active":true},"body":"Rather than inventing a new way, the exposed table name should be a TableName rather than a simple String. (org.apache.derby.impl.sql.compile.TableName). Some of the query nodes already have a method TableName getExposedTableName(), all instances and uses of String getExposedName() should be changed to TableName getExposedTableName().\r\n\r\nThe change is probably a little more involved than that, but that should be the general idea.","updateAuthor":{"self":"https://issues.apache.org/jira/rest/api/2/user?username=djd","name":"djd","emailAddress":"djd at apache dot org","avatarUrls":{"48x48":"https://issues.apache.org/jira/secure/useravatar?avatarId=10452","24x24":"https://issues.apache.org/jira/secure/useravatar?size=small&avatarId=10452","16x16":"https://issues.apache.org/jira/secure/useravatar?size=xsmall&avatarId=10452","32x32":"https://issues.apache.org/jira/secure/useravatar?size=medium&avatarId=10452"},"displayName":"Daniel John Debrunner","active":true},"created":"2004-12-02T16:39:49.000+0000","updated":"2004-12-02T16:39:49.000+0000"},{"self":"https://issues.apache.org/jira/rest/api/2/issue/27518/comment/57002","id":"57002","author":{"self":"https://issues.apache.org/jira/rest/api/2/user?username=shreyas","name":"shreyas","emailAddress":"Shreyas at sun dot com","avatarUrls":{"48x48":"https://issues.apache.org/jira/secure/useravatar?avatarId=10452","24x24":"https://issues.apache.org/jira/secure/useravatar?size=small&avatarId=10452","16x16":"https://issues.apache.org/jira/secure/useravatar?size=xsmall&avatarId=10452","32x32":"https://issues.apache.org/jira/secure/useravatar?size=medium&avatarId=10452"},"displayName":"Shreyas Kaushik","active":true},"body":"In response to Sateesh's comments:\r\n\r\n Should the behaviour for the two queries you mentioned in your example, be taken care of at the compile time or bind time ? I feel they should be probably under a seperate bug, shouldn't they ? As this is likely to have a much larger impact.\r\n\r\nFor this bug it is how the from list behaves and the comparision that needs to go in here, as Dan has suggested used the getExposedTableName approach.\r\n\r\n","updateAuthor":{"self":"https://issues.apache.org/jira/rest/api/2/user?username=shreyas","name":"shreyas","emailAddress":"Shreyas at sun dot com","avatarUrls":{"48x48":"https://issues.apache.org/jira/secure/useravatar?avatarId=10452","24x24":"https://issues.apache.org/jira/secure/useravatar?size=small&avatarId=10452","16x16":"https://issues.apache.org/jira/secure/useravatar?size=xsmall&avatarId=10452","32x32":"https://issues.apache.org/jira/secure/useravatar?size=medium&avatarId=10452"},"displayName":"Shreyas Kaushik","active":true},"created":"2004-12-23T05:23:25.000+0000","updated":"2004-12-23T05:23:25.000+0000"},{"self":"https://issues.apache.org/jira/rest/api/2/issue/27518/comment/57080","id":"57080","author":{"self":"https://issues.apache.org/jira/rest/api/2/user?username=bandaram","name":"bandaram","emailAddress":"bandaram at gmail dot com","avatarUrls":{"48x48":"https://issues.apache.org/jira/secure/useravatar?avatarId=10452","24x24":"https://issues.apache.org/jira/secure/useravatar?size=small&avatarId=10452","16x16":"https://issues.apache.org/jira/secure/useravatar?size=xsmall&avatarId=10452","32x32":"https://issues.apache.org/jira/secure/useravatar?size=medium&avatarId=10452"},"displayName":"Satheesh Bandaram","active":true},"body":"I think this is a bind issue, still. For the following query:\r\n\r\nselect \"S1.T1\".* from s1.t1; \r\n\r\n\"S1.T1\" is being considered same as s1.t1. This seems to happen in FromList.java:\r\n\r\npublic ResultColumnList getResultColumnsForList(String allTableName,ResultColumnList inputRcl,Name tableName)\r\n........................\r\n  /* If allTableName is non-null, then we must check to see if it matches \r\n  * our exposed name.\r\n  */\r\n  if (allTableName != null && ! allTableName.equals(getExposedName()))\r\n  {\r\n\treturn null;\r\n  }\r\n\r\nIf all exposed names are being changed to TableNames, like Dan suggested, then this comparison here should not be a string based comparison.","updateAuthor":{"self":"https://issues.apache.org/jira/rest/api/2/user?username=bandaram","name":"bandaram","emailAddress":"bandaram at gmail dot com","avatarUrls":{"48x48":"https://issues.apache.org/jira/secure/useravatar?avatarId=10452","24x24":"https://issues.apache.org/jira/secure/useravatar?size=small&avatarId=10452","16x16":"https://issues.apache.org/jira/secure/useravatar?size=xsmall&avatarId=10452","32x32":"https://issues.apache.org/jira/secure/useravatar?size=medium&avatarId=10452"},"displayName":"Satheesh Bandaram","active":true},"created":"2004-12-28T01:40:19.000+0000","updated":"2004-12-28T01:40:19.000+0000"},{"self":"https://issues.apache.org/jira/rest/api/2/issue/27518/comment/57083","id":"57083","author":{"self":"https://issues.apache.org/jira/rest/api/2/user?username=hlavac","name":"hlavac","emailAddress":"hlavac at code dot cz","avatarUrls":{"48x48":"https://issues.apache.org/jira/secure/useravatar?avatarId=10452","24x24":"https://issues.apache.org/jira/secure/useravatar?size=small&avatarId=10452","16x16":"https://issues.apache.org/jira/secure/useravatar?size=xsmall&avatarId=10452","32x32":"https://issues.apache.org/jira/secure/useravatar?size=medium&avatarId=10452"},"displayName":"Jan Hlavatý","active":true},"body":"Maybe the table names could be converted to canonical form before being used/compared?\r\nAfter all, s1.t1 is just an easy way to write \"S1\".\"T1\", and should be threated as such.\r\n","updateAuthor":{"self":"https://issues.apache.org/jira/rest/api/2/user?username=hlavac","name":"hlavac","emailAddress":"hlavac at code dot cz","avatarUrls":{"48x48":"https://issues.apache.org/jira/secure/useravatar?avatarId=10452","24x24":"https://issues.apache.org/jira/secure/useravatar?size=small&avatarId=10452","16x16":"https://issues.apache.org/jira/secure/useravatar?size=xsmall&avatarId=10452","32x32":"https://issues.apache.org/jira/secure/useravatar?size=medium&avatarId=10452"},"displayName":"Jan Hlavatý","active":true},"created":"2004-12-28T11:09:13.000+0000","updated":"2004-12-28T11:09:13.000+0000"},{"self":"https://issues.apache.org/jira/rest/api/2/issue/27518/comment/57085","id":"57085","author":{"self":"https://issues.apache.org/jira/rest/api/2/user?username=shreyas","name":"shreyas","emailAddress":"Shreyas at sun dot com","avatarUrls":{"48x48":"https://issues.apache.org/jira/secure/useravatar?avatarId=10452","24x24":"https://issues.apache.org/jira/secure/useravatar?size=small&avatarId=10452","16x16":"https://issues.apache.org/jira/secure/useravatar?size=xsmall&avatarId=10452","32x32":"https://issues.apache.org/jira/secure/useravatar?size=medium&avatarId=10452"},"displayName":"Shreyas Kaushik","active":true},"body":"In response to Sateesh's comment:\r\n\r\nHere in this method the allTableName is just a String and we cannot know the schema name for that table. Only for the table in the from list can the schema be known. So it is still a compile / bind time issue.\r\n","updateAuthor":{"self":"https://issues.apache.org/jira/rest/api/2/user?username=shreyas","name":"shreyas","emailAddress":"Shreyas at sun dot com","avatarUrls":{"48x48":"https://issues.apache.org/jira/secure/useravatar?avatarId=10452","24x24":"https://issues.apache.org/jira/secure/useravatar?size=small&avatarId=10452","16x16":"https://issues.apache.org/jira/secure/useravatar?size=xsmall&avatarId=10452","32x32":"https://issues.apache.org/jira/secure/useravatar?size=medium&avatarId=10452"},"displayName":"Shreyas Kaushik","active":true},"created":"2004-12-28T14:11:34.000+0000","updated":"2004-12-28T14:11:34.000+0000"},{"self":"https://issues.apache.org/jira/rest/api/2/issue/27518/comment/57109","id":"57109","author":{"self":"https://issues.apache.org/jira/rest/api/2/user?username=maverick","name":"maverick","emailAddress":"amit dot handa at sun dot com","avatarUrls":{"48x48":"https://issues.apache.org/jira/secure/useravatar?avatarId=10452","24x24":"https://issues.apache.org/jira/secure/useravatar?size=small&avatarId=10452","16x16":"https://issues.apache.org/jira/secure/useravatar?size=xsmall&avatarId=10452","32x32":"https://issues.apache.org/jira/secure/useravatar?size=medium&avatarId=10452"},"displayName":"Amit Handa","active":true},"body":"I think we need to understand that we are using String for TableName and not as an object of type TableName.java. Hence associating a schema with a table name which would otherwise have been possible(TableName.setSchemaName) cannot happen, is a problem.\r\n\r\nSecondly irrespective of whether a user gives a schema name (prefixes or not) we need to store the schema name(after clearly identifying the schema name), for every table name and cannot assume it to be NULL, else we get in problems like this.\r\n\r\nSo \r\n\r\n1. either change from String tableName to TableName tableName.\r\n\r\n2. build a tableName object(of type TableName object) from the String and try to get handle to schema name (using the select query String as well).\r\n\r\nNote : the basic objective of either approach is to get handle to a schema name as and when it is required.\r\n\r\n1. is complex and may involve lot of changes wheras 2. is fairly simple.\r\nIf we can achive using 2 that will be better.\r\n\r\n\r\n\r\n\r\n\r\n\r\n\r\n","updateAuthor":{"self":"https://issues.apache.org/jira/rest/api/2/user?username=maverick","name":"maverick","emailAddress":"amit dot handa at sun dot com","avatarUrls":{"48x48":"https://issues.apache.org/jira/secure/useravatar?avatarId=10452","24x24":"https://issues.apache.org/jira/secure/useravatar?size=small&avatarId=10452","16x16":"https://issues.apache.org/jira/secure/useravatar?size=xsmall&avatarId=10452","32x32":"https://issues.apache.org/jira/secure/useravatar?size=medium&avatarId=10452"},"displayName":"Amit Handa","active":true},"created":"2004-12-29T05:01:16.000+0000","updated":"2004-12-29T05:01:16.000+0000"},{"self":"https://issues.apache.org/jira/rest/api/2/issue/27518/comment/57179","id":"57179","author":{"self":"https://issues.apache.org/jira/rest/api/2/user?username=shreyas","name":"shreyas","emailAddress":"Shreyas at sun dot com","avatarUrls":{"48x48":"https://issues.apache.org/jira/secure/useravatar?avatarId=10452","24x24":"https://issues.apache.org/jira/secure/useravatar?size=small&avatarId=10452","16x16":"https://issues.apache.org/jira/secure/useravatar?size=xsmall&avatarId=10452","32x32":"https://issues.apache.org/jira/secure/useravatar?size=medium&avatarId=10452"},"displayName":"Shreyas Kaushik","active":true},"body":"I am proposing a fix for this issue. I am attaching the diffs of all the files that need to have changes.\r\n\r\nAs per the discussions we have had on this issue the problem was with comparing exposed names. I have changed the comparision of all exposed names to the TableName objects. \r\n\r\nAs Sateesh had suggested in one of his earlier mails on this issue,  \r\n\r\npublic ResultColumnList getResultColumnsForList(String allTableName,ResultColumnList inputRcl,Name tableName)\r\n\r\n method in the FromTable.java the \"allTableName\" needs to be a TableName object instead of a String object. I have made those changes as well for the comparision to happen between TableName objects.\r\n\r\n  For the above change to happen we need to get a handle to the TableName object that is stored in the java/engine/org/apache/derby/impl/sql/compile/AllResultColumn. As of now it does not have a method to actually get a handle to the TableName object stored in this. So I added a new method that returns a handle to the TableName object stored internally.\r\n\r\nI also ran the tests of derbylang and am attaching the diffs of them as well. Some of the tests fail there and I don't know the exact reason for the failures.( I think they are not failures )","updateAuthor":{"self":"https://issues.apache.org/jira/rest/api/2/user?username=shreyas","name":"shreyas","emailAddress":"Shreyas at sun dot com","avatarUrls":{"48x48":"https://issues.apache.org/jira/secure/useravatar?avatarId=10452","24x24":"https://issues.apache.org/jira/secure/useravatar?size=small&avatarId=10452","16x16":"https://issues.apache.org/jira/secure/useravatar?size=xsmall&avatarId=10452","32x32":"https://issues.apache.org/jira/secure/useravatar?size=medium&avatarId=10452"},"displayName":"Shreyas Kaushik","active":true},"created":"2005-01-03T13:46:21.000+0000","updated":"2005-01-03T13:46:21.000+0000"},{"self":"https://issues.apache.org/jira/rest/api/2/issue/27518/comment/57180","id":"57180","author":{"self":"https://issues.apache.org/jira/rest/api/2/user?username=shreyas","name":"shreyas","emailAddress":"Shreyas at sun dot com","avatarUrls":{"48x48":"https://issues.apache.org/jira/secure/useravatar?avatarId=10452","24x24":"https://issues.apache.org/jira/secure/useravatar?size=small&avatarId=10452","16x16":"https://issues.apache.org/jira/secure/useravatar?size=xsmall&avatarId=10452","32x32":"https://issues.apache.org/jira/secure/useravatar?size=medium&avatarId=10452"},"displayName":"Shreyas Kaushik","active":true},"body":"Latest proposed patch for Derby-13","updateAuthor":{"self":"https://issues.apache.org/jira/rest/api/2/user?username=shreyas","name":"shreyas","emailAddress":"Shreyas at sun dot com","avatarUrls":{"48x48":"https://issues.apache.org/jira/secure/useravatar?avatarId=10452","24x24":"https://issues.apache.org/jira/secure/useravatar?size=small&avatarId=10452","16x16":"https://issues.apache.org/jira/secure/useravatar?size=xsmall&avatarId=10452","32x32":"https://issues.apache.org/jira/secure/useravatar?size=medium&avatarId=10452"},"displayName":"Shreyas Kaushik","active":true},"created":"2005-01-03T13:47:52.000+0000","updated":"2005-01-03T13:47:52.000+0000"},{"self":"https://issues.apache.org/jira/rest/api/2/issue/27518/comment/57181","id":"57181","author":{"self":"https://issues.apache.org/jira/rest/api/2/user?username=shreyas","name":"shreyas","emailAddress":"Shreyas at sun dot com","avatarUrls":{"48x48":"https://issues.apache.org/jira/secure/useravatar?avatarId=10452","24x24":"https://issues.apache.org/jira/secure/useravatar?size=small&avatarId=10452","16x16":"https://issues.apache.org/jira/secure/useravatar?size=xsmall&avatarId=10452","32x32":"https://issues.apache.org/jira/secure/useravatar?size=medium&avatarId=10452"},"displayName":"Shreyas Kaushik","active":true},"body":"Test run report with diffs of tests that are failing","updateAuthor":{"self":"https://issues.apache.org/jira/rest/api/2/user?username=shreyas","name":"shreyas","emailAddress":"Shreyas at sun dot com","avatarUrls":{"48x48":"https://issues.apache.org/jira/secure/useravatar?avatarId=10452","24x24":"https://issues.apache.org/jira/secure/useravatar?size=small&avatarId=10452","16x16":"https://issues.apache.org/jira/secure/useravatar?size=xsmall&avatarId=10452","32x32":"https://issues.apache.org/jira/secure/useravatar?size=medium&avatarId=10452"},"displayName":"Shreyas Kaushik","active":true},"created":"2005-01-03T13:48:52.000+0000","updated":"2005-01-03T13:48:52.000+0000"},{"self":"https://issues.apache.org/jira/rest/api/2/issue/27518/comment/57923","id":"57923","author":{"self":"https://issues.apache.org/jira/rest/api/2/user?username=djd","name":"djd","emailAddress":"djd at apache dot org","avatarUrls":{"48x48":"https://issues.apache.org/jira/secure/useravatar?avatarId=10452","24x24":"https://issues.apache.org/jira/secure/useravatar?size=small&avatarId=10452","16x16":"https://issues.apache.org/jira/secure/useravatar?size=xsmall&avatarId=10452","32x32":"https://issues.apache.org/jira/secure/useravatar?size=medium&avatarId=10452"},"displayName":"Daniel John Debrunner","active":true},"body":"Committed patch from Shreyas Kaushik <Shreyas.Kaushik@Sun.COM>\r\n\r\nsvn revision 125980","updateAuthor":{"self":"https://issues.apache.org/jira/rest/api/2/user?username=djd","name":"djd","emailAddress":"djd at apache dot org","avatarUrls":{"48x48":"https://issues.apache.org/jira/secure/useravatar?avatarId=10452","24x24":"https://issues.apache.org/jira/secure/useravatar?size=small&avatarId=10452","16x16":"https://issues.apache.org/jira/secure/useravatar?size=xsmall&avatarId=10452","32x32":"https://issues.apache.org/jira/secure/useravatar?size=medium&avatarId=10452"},"displayName":"Daniel John Debrunner","active":true},"created":"2005-01-22T08:38:09.000+0000","updated":"2005-01-22T08:38:09.000+0000"},{"self":"https://issues.apache.org/jira/rest/api/2/issue/27518/comment/66240","id":"66240","author":{"self":"https://issues.apache.org/jira/rest/api/2/user?username=shreyas","name":"shreyas","emailAddress":"Shreyas at sun dot com","avatarUrls":{"48x48":"https://issues.apache.org/jira/secure/useravatar?avatarId=10452","24x24":"https://issues.apache.org/jira/secure/useravatar?size=small&avatarId=10452","16x16":"https://issues.apache.org/jira/secure/useravatar?size=xsmall&avatarId=10452","32x32":"https://issues.apache.org/jira/secure/useravatar?size=medium&avatarId=10452"},"displayName":"Shreyas Kaushik","active":true},"body":"Fixed, as per the earlier comment from Dan","updateAuthor":{"self":"https://issues.apache.org/jira/rest/api/2/user?username=shreyas","name":"shreyas","emailAddress":"Shreyas at sun dot com","avatarUrls":{"48x48":"https://issues.apache.org/jira/secure/useravatar?avatarId=10452","24x24":"https://issues.apache.org/jira/secure/useravatar?size=small&avatarId=10452","16x16":"https://issues.apache.org/jira/secure/useravatar?size=xsmall&avatarId=10452","32x32":"https://issues.apache.org/jira/secure/useravatar?size=medium&avatarId=10452"},"displayName":"Shreyas Kaushik","active":true},"created":"2005-05-25T15:53:13.000+0000","updated":"2005-05-25T15:53:13.000+0000"},{"self":"https://issues.apache.org/jira/rest/api/2/issue/27518/comment/66247","id":"66247","author":{"self":"https://issues.apache.org/jira/rest/api/2/user?username=shreyas","name":"shreyas","emailAddress":"Shreyas at sun dot com","avatarUrls":{"48x48":"https://issues.apache.org/jira/secure/useravatar?avatarId=10452","24x24":"https://issues.apache.org/jira/secure/useravatar?size=small&avatarId=10452","16x16":"https://issues.apache.org/jira/secure/useravatar?size=xsmall&avatarId=10452","32x32":"https://issues.apache.org/jira/secure/useravatar?size=medium&avatarId=10452"},"displayName":"Shreyas Kaushik","active":true},"body":"Patch submitted","updateAuthor":{"self":"https://issues.apache.org/jira/rest/api/2/user?username=shreyas","name":"shreyas","emailAddress":"Shreyas at sun dot com","avatarUrls":{"48x48":"https://issues.apache.org/jira/secure/useravatar?avatarId=10452","24x24":"https://issues.apache.org/jira/secure/useravatar?size=small&avatarId=10452","16x16":"https://issues.apache.org/jira/secure/useravatar?size=xsmall&avatarId=10452","32x32":"https://issues.apache.org/jira/secure/useravatar?size=medium&avatarId=10452"},"displayName":"Shreyas Kaushik","active":true},"created":"2005-05-25T16:55:40.000+0000","updated":"2005-05-25T16:55:40.000+0000"}]},"votes":{"self":"https://issues.apache.org/jira/rest/api/2/issue/DERBY-13/votes","votes":2,"hasVoted":false},"worklog":{"startAt":0,"maxResults":20,"total":0,"worklogs":[]},"customfield_12311820":"0|i07ba7:"}}